/*! project-name v0.0.1 | (c) 2019 YOUR NAME | MIT License | http://link-to-your-git-repo.com */
const app={};let searchedAll=[];const allergySelected=[];let ajaxResult,storedResult,dietSelected="none",maxTimeSelected="none";app.mainSearchEvent=function(){$("#form-search-main").on("submit",(function(e){e.preventDefault(),$("label").removeClass("active"),app.getMainInfo(),app.searchedTitle(searchedAll),app.headerHeightVH(),app.widthHandlerSubmitted(),$("#search").blur(),this.reset(),app.scrollToTopRecipe()}))},app.scrollToTopRecipe=function(){$("html,body").animate({scrollTop:$(".recipe-wrapper").offset().top},800)},app.scrollToTopHeader=function(){$("html,body").animate({scrollTop:$("header").offset().top},800)},app.headerHeightVH=function(){$("header").css("height","100vh")},app.updateIngredients=function(){if(searchedAll.length>0){$(".searched-ingredient").text("Searched Ingredients:");for(var e=0;e<searchedAll.length;e++)$(".searched-ingredient").append(`<span class="searched-each">${searchedAll[e]}</span>`)}},app.getMainInfo=function(){if($("input[type=search]").val()){const e=$("input[name=ingredient]").val();$(".searched-ingredient").append(`<span class="searched-each">${e}</span>`),searchedAll.push(e)}const e=[],t=$(".allergies input[type=checkbox]").filter($("input:checked"));e.push(...t);for(var i=0;i<e.length;i++)allergySelected.push(e[i].value);dietSelected=$(".diets input[type=radio]").filter($("input:checked")).val(),maxTimeSelected=$(".duration input[type=radio]").filter($("input:checked")).val(),$(".searched-ingredient").css("display","flex"),$(".recipe-wrapper").css("display","block"),app.getRecip(searchedAll,allergySelected,dietSelected,maxTimeSelected),app.updateIngredients()},app.searchedTitle=function(e){$("#recipes").empty()},app.getRecip=function(e,t,i,a){$.ajax({url:"http://api.yummly.com/v1/api/recipes",dataType:"json",data:{_app_id:"1d2af616",_app_key:"ff279905f6336ced45e39d38f120592e",maxResult:12,q:e,allowedAllergy:t,maxTotalTimeInSeconds:a,allowedDiet:i}}).then(e=>{console.log(e),ajaxResult=e,app.showResult(ajaxResult)})},app.showResult=function(e){e.matches.forEach((function(e){const t=e.recipeName,i=e.sourceDisplayName,a=e.imageUrlsBySize,n=e.id,c=e.totalTimeInSeconds,p=$('<h4 class="recipe-title">').text(t),l=$('<h6 class="recipe-unique">').text(i),s=a[90].split("=")[0],d=$('<img class="recipe-img">').attr("src",s),o=$(`<a href="https://www.yummly.com/recipe/${n}" target="_blank"></a>`).append(d),r=$('<p class="ingredients-title" target="_blank">').text("Ingredients"),h=c/60,u=$('<h6 class="duration-each">').text(`Time: ${h} Min`),g=$('<div class="ing-dur">').append(u,r),m=$("<div>").addClass("recipe-item").append(p,l,o,g);$("#recipes").append(m)}))},app.checkboxToggle=function(){$(".allergies label").click((function(){$(this).toggleClass("active")}))},app.dietsToggle=function(e){$(".diets input[type=radio]").change((function(){$(".diets label").removeClass("active"),this.checked&&($(this).next().toggleClass("active"),$(this).val())}))},app.durationToggle=function(e){$(".duration input[type=radio]").change((function(){$(".duration label").removeClass("active"),this.checked&&($(this).next().toggleClass("active"),$(this).val())}))},app.updateRecipe=function(){$(document).on("click",".searched-each",(function(){const e=this.innerHTML;$(this).remove();const t=searchedAll.filter((function(t){return e!==t}));searchedAll=t,$("#recipes").empty(),0===t.length?($("#recipes").empty(),$(".searched-ingredient").empty(),$(".searched-ingredient").text("Please search an ingredient"),app.scrollToTopHeader()):(app.getRecip(t,allergySelected,dietSelected,maxTimeSelected),app.scrollToTopRecipe())}))},app.widthHandler=function(){$(window).resize((function(){$(window).width()<350?$("header").css("height","auto"):$("header").css("height","96vh")}))},app.widthHandlerSubmitted=function(){$(window).resize((function(){$(window).width()<350?$("header").css("height","auto"):app.headerHeightVH()}))};let clicked=!1;app.indIngredients=function(){$(document).on("click",".ingredients-title",(function(){const e=ajaxResult.matches;if(console.log(ajaxResult),console.log("clicked"),!1===clicked){const i=$(".ingredients-title").index(this);console.log(i);const a=e[i].ingredients,n=$("<ul class=ingredients-ul>"),c=$('<h4 class="ingredients-exp">').text("Ingredients:");n.append(c);for(var t=0;t<a.length;t++){const e=$('<li class="ingredients-each">').text(`${a[t]}`);n.append(e)}$(this.parentElement.parentElement).append(n),clicked=!0}else!0===clicked&&$(".ingredients-ul").on("click",app.hideIngredients())})),$(document).on("click",".ingredients-ul",(function(){app.hideIngredients(),clicked=!1}))},app.hideIngredients=function(){$(".ingredients-ul").css("display","none"),clicked=!1},app.init=function(){app.mainSearchEvent(),app.checkboxToggle(),app.dietsToggle(),app.durationToggle(),app.widthHandler(),app.updateRecipe(),app.indIngredients()},$(document).ready((function(){app.init()})),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);